<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!--
库房出库明细。操作相关SQL Mapper
@author Lanpz
@date 2016-12-20
@source Generated by MySQL2Java
-->

<!-- 此命名空间必须和对应Mapper.java文件的命名空间一致 -->
<mapper namespace="com.aek.persistence.oracle.mapper.OSdHplStockOutItemsMapper">

    <!-- 库房出库明细。栏位列表 -->
    <resultMap id="rm" type="com.aek.persistence.oracle.beans.SdHplStockOutItems">
        <result property="itemId" jdbcType="BIGINT" column="item_id" />
        <result property="areaId" jdbcType="INTEGER" column="area_id" />
        <result property="sysId" jdbcType="BIGINT" column="sys_id" />
        <result property="whId" jdbcType="BIGINT" column="wh_id" />
        <result property="whName" jdbcType="VARCHAR" column="wh_name"/>
        <result property="whSiteId" jdbcType="BIGINT" column="wh_site_id" />
        <result property="whSiteName" jdbcType="VARCHAR" column="wh_site_name"/>
        <result property="formId" jdbcType="BIGINT" column="form_id" />
        <result property="itemIndex" jdbcType="INTEGER" column="item_index" />
        <result property="exchangeId" jdbcType="BIGINT" column="exchange_id" />
        <result property="specId" jdbcType="BIGINT" column="spec_id" />
        <result property="specModel" jdbcType="VARCHAR" column="spec_model"/>
        <result property="goodsName" jdbcType="VARCHAR" column="goods_name" />
        <result property="commonName" jdbcType="VARCHAR" column="common_name" />
        <result property="specSize" jdbcType="VARCHAR" column="spec_size" />
        <result property="regNo" jdbcType="VARCHAR" column="reg_no" />
        <result property="specUnit" jdbcType="VARCHAR" column="spec_unit" />
        <result property="unitPrice" jdbcType="DOUBLE" column="unit_price" />
        <result property="specPackage" jdbcType="VARCHAR" column="spec_package" />
        <result property="splId" jdbcType="BIGINT" column="spl_id" />
        <result property="splName" jdbcType="VARCHAR" column="spl_name"/>
        <result property="facId" jdbcType="BIGINT" column="fac_id" />
        <result property="facName" jdbcType="VARCHAR" column="fac_name"/>
        <result property="factoryAddr" jdbcType="VARCHAR" column="factory_addr" />
        <result property="specBrand" jdbcType="VARCHAR" column="spec_brand" />
        <result property="stockOutQty" jdbcType="INTEGER" column="stock_out_qty" />
        <result property="stockPrice" jdbcType="DOUBLE" column="stock_price" />
        <result property="stockGiftQty" jdbcType="INTEGER" column="stock_gift_qty" />
        <result property="stockReturnQty" jdbcType="INTEGER" column="stock_return_qty" />
        <result property="stockOldQty" jdbcType="INTEGER" column="stock_old_qty" />
        <result property="stockAmount" jdbcType="DOUBLE" column="stock_amount" />
        <result property="specBarcodeType" jdbcType="BIGINT" column="spec_barcode_type" />
        <result property="barcodeId" jdbcType="BIGINT" column="barcode_id" />
        <result property="barcodeStr" jdbcType="VARCHAR" column="barcode_str" />
        <result property="batchNo" jdbcType="VARCHAR" column="batch_no" />
        <result property="productDate" jdbcType="VARCHAR" column="product_date" />
        <result property="expiredDate" jdbcType="VARCHAR" column="expired_date" />
        <result property="sterilizeNo" jdbcType="VARCHAR" column="sterilize_no" />
        <result property="sterilizeDate" jdbcType="VARCHAR" column="sterilize_date" />
        <result property="lockFlag" jdbcType="INTEGER" column="lock_flag" />
        <result property="reqItemId" jdbcType="INTEGER" column="req_item_id" />
        <result property="stockCheckReason" jdbcType="VARCHAR" column="stock_check_reason" />
        <result property="redItemId" jdbcType="BIGINT" column="red_item_id" />
        <result property="addBy" jdbcType="BIGINT" column="add_by" />
        <result property="addName" jdbcType="VARCHAR" column="add_name" />
        <result property="addTime" jdbcType="VARCHAR" column="add_time"/>
        <result property="delFlag" jdbcType="INTEGER" column="del_flag"/>
        <result property="lastEditBy" jdbcType="BIGINT" column="last_edit_by" />
        <result property="lastEditName" jdbcType="VARCHAR" column="last_edit_name" />
        <result property="lastEditTime" jdbcType="VARCHAR" column="last_edit_time" />
        <result property="curId" jdbcType="BIGINT" column="cur_id" />
        <result property="accountType" jdbcType="BIGINT" column="account_type" />
        <result property="calcType" jdbcType="BIGINT" column="calc_type" />
        <result property="stockRedQty" jdbcType="INTEGER" column="stock_red_qty" />
        <result property="stockAccQty" jdbcType="INTEGER" column="stock_acc_qty" />
        <result property="stockBudgetQty" jdbcType="INTEGER" column="stock_budget_qty" />
        <result property="stockCancelQty" jdbcType="INTEGER" column="stock_cancel_qty" />
        <result property="stockBackQty" jdbcType="INTEGER" column="stock_back_qty" />
        <result property="accItemId" jdbcType="BIGINT" column="acc_item_id" />
        <result property="budgetItemId" jdbcType="BIGINT" column="budget_item_id" />
        <result property="cancelItemId" jdbcType="BIGINT" column="cancel_item_id" />
        <result property="returnItemId" jdbcType="BIGINT" column="return_item_id" />
        <result property="backItemId" jdbcType="BIGINT" column="back_item_id" />
    </resultMap>

    <!-- 获取库房出库明细。 -->
    <select id="getItemList" resultMap="rm" parameterType="java.util.Map">
        SELECT *
          FROM sd_hpl_stock_out_items
         WHERE item_id IN
        <foreach collection="list" item="item" separator="," open="(" close=")">
            #{item.itemId}        
        </foreach> 
    </select>
    
    <select id="getCount" resultType="int">
        SELECT count(*) 
          FROM sd_hpl_stock_out_items
    </select>

    <!-- 添加库房出库明细。 -->
    <insert id="insertList" parameterType="java.util.List">
        INSERT INTO sd_hpl_stock_out_items(item_id,area_id,sys_id,wh_id,wh_name,wh_site_id,wh_site_name,form_id,item_index,exchange_id,spec_id,spec_model,goods_name,common_name,spec_size,reg_no,spec_unit,unit_price,spec_package,spl_id,spl_name,fac_id,fac_name,factory_addr,spec_brand,stock_out_qty,stock_price,stock_gift_qty,stock_return_qty,stock_old_qty,stock_amount,spec_barcode_type,barcode_id,barcode_str,batch_no,product_date,expired_date,sterilize_no,sterilize_date,lock_flag,req_item_id,stock_check_reason,red_item_id,add_by,add_time,add_name,del_flag,last_edit_by,last_edit_name,last_edit_time,cur_id,account_type,calc_type,stock_red_qty,stock_acc_qty,stock_budget_qty,stock_cancel_qty,stock_back_qty,acc_item_id,budget_item_id,cancel_item_id,return_item_id,back_item_id)
        <foreach collection="list" item="item" separator=" union all ">
        SELECT 
               #{item.itemId, jdbcType=BIGINT},
               #{item.areaId, jdbcType=BIGINT},
               #{item.sysId, jdbcType=BIGINT},
               #{item.whId, jdbcType=BIGINT},
               #{item.whName, jdbcType=VARCHAR},
               #{item.whSiteId, jdbcType=BIGINT},
               #{item.whSiteName, jdbcType=VARCHAR},
               #{item.formId, jdbcType=BIGINT},
               #{item.itemIndex, jdbcType=INTEGER},
               #{item.exchangeId, jdbcType=BIGINT},
               #{item.specId, jdbcType=BIGINT},
               #{item.specModel, jdbcType=VARCHAR},
               #{item.goodsName, jdbcType=VARCHAR},
               #{item.commonName, jdbcType=VARCHAR},
               #{item.specSize, jdbcType=VARCHAR},
               #{item.regNo, jdbcType=VARCHAR},
               #{item.specUnit, jdbcType=VARCHAR},
               #{item.unitPrice, jdbcType=DOUBLE},
               #{item.specPackage, jdbcType=VARCHAR},
               #{item.splId, jdbcType=BIGINT},
               #{item.splName, jdbcType=VARCHAR},
               #{item.facId, jdbcType=BIGINT},
               #{item.facName, jdbcType=VARCHAR},
               #{item.factoryAddr, jdbcType=VARCHAR},
               #{item.specBrand, jdbcType=VARCHAR},
               #{item.stockOutQty, jdbcType=INTEGER},
               #{item.stockPrice, jdbcType=DOUBLE},
               #{item.stockGiftQty, jdbcType=INTEGER},
               #{item.stockReturnQty, jdbcType=INTEGER},
               #{item.stockOldQty, jdbcType=INTEGER},
               #{item.stockAmount, jdbcType=DOUBLE},
               #{item.specBarcodeType, jdbcType=BIGINT},
               #{item.barcodeId, jdbcType=BIGINT},
               #{item.barcodeStr, jdbcType=VARCHAR},
               #{item.batchNo, jdbcType=VARCHAR},
               to_date(#{item.productDate, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               to_date(#{item.expiredDate, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.sterilizeNo, jdbcType=VARCHAR},
               to_date(#{item.sterilizeDate, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.lockFlag, jdbcType=INTEGER},
               #{item.reqItemId, jdbcType=BIGINT},
               #{item.stockCheckReason, jdbcType=VARCHAR},
               #{item.redItemId, jdbcType=BIGINT},
               #{item.addBy, jdbcType=BIGINT},
               to_date(#{item.addTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.addName, jdbcType=VARCHAR},
               #{item.delFlag, jdbcType=INTEGER},
               #{item.lastEditBy, jdbcType=BIGINT},
               #{lastEditName, jdbcType=VARCHAR},
               to_date(#{item.lastEditTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.curId, jdbcType=BIGINT},
               #{item.accountType, jdbcType=BIGINT},
               #{item.calcType, jdbcType=BIGINT},
               #{item.stockRedQty, jdbcType=INTEGER},
               #{item.stockAccQty, jdbcType=INTEGER},
               #{item.stockBudgetQty, jdbcType=INTEGER},
               #{item.stockCancelQty, jdbcType=INTEGER},
               #{item.stockBackQty, jdbcType=INTEGER},
               #{item.accItemId, jdbcType=BIGINT},
               #{item.budgetItemId, jdbcType=BIGINT},
               #{item.cancelItemId, jdbcType=BIGINT},
               #{item.returnItemId, jdbcType=BIGINT},
               #{item.backItemId, jdbcType=BIGINT}
          FROM dual
        </foreach>
    </insert>

    <!-- 修改库房出库明细。 -->
    <update id="updateList" parameterType="java.util.List">
    <foreach collection="list" item="item" separator=";" open="BEGIN " close=";END;">
        UPDATE sd_hpl_stock_out_items
           SET area_id=#{item.areaId, jdbcType=INTEGER},
               sys_id=#{item.sysId, jdbcType=BIGINT},
               wh_id=#{item.whId, jdbcType=BIGINT},
               wh_name=#{item.whName, jdbcType=VARCHAR},
               wh_site_id=#{item.whSiteId, jdbcType=BIGINT},
               wh_site_name=#{item.whSiteName, jdbcType=VARCHAR},
               form_id=#{item.formId, jdbcType=BIGINT},
               item_index=#{item.itemIndex, jdbcType=INTEGER},
               exchange_id=#{item.exchangeId, jdbcType=BIGINT},
               spec_id=#{item.specId, jdbcType=BIGINT},
               spec_model=#{item.specModel, jdbcType=VARCHAR},
               goods_name=#{item.goodsName, jdbcType=VARCHAR},
               common_name=#{item.commonName, jdbcType=VARCHAR},
               spec_size=#{item.specSize, jdbcType=VARCHAR},
               reg_no=#{item.regNo, jdbcType=VARCHAR},
               spec_unit=#{item.specUnit, jdbcType=VARCHAR},
               unit_price=#{item.unitPrice, jdbcType=DOUBLE},
               spec_package=#{item.specPackage, jdbcType=VARCHAR},
               spl_id=#{item.splId, jdbcType=BIGINT},
               spl_name=#{item.splName, jdbcType=VARCHAR},
               fac_id=#{item.facId, jdbcType=BIGINT},
               fac_name=#{item.facName, jdbcType=VARCHAR},
               factory_addr=#{item.factoryAddr, jdbcType=VARCHAR},
               spec_brand=#{item.specBrand, jdbcType=VARCHAR},
               stock_out_qty=#{item.stockOutQty, jdbcType=INTEGER},
               stock_price=#{item.stockPrice, jdbcType=DOUBLE},
               stock_gift_qty=#{item.stockGiftQty, jdbcType=INTEGER},
               stock_return_qty=#{item.stockReturnQty, jdbcType=INTEGER},
               stock_old_qty=#{item.stockOldQty, jdbcType=INTEGER},
               stock_amount=#{item.stockAmount, jdbcType=DOUBLE},
               spec_barcode_type=#{item.specBarcodeType, jdbcType=BIGINT},
               barcode_id=#{item.barcodeId, jdbcType=BIGINT},
               barcode_str=#{item.barcodeStr, jdbcType=VARCHAR},
               batch_no=#{item.batchNo, jdbcType=VARCHAR},
               product_date=to_date(#{item.productDate, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               expired_date=to_date(#{item.expiredDate, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               sterilize_no=#{item.sterilizeNo, jdbcType=VARCHAR},
               sterilize_date=to_date(#{item.sterilizeDate, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               lock_flag=#{item.lockFlag, jdbcType=INTEGER},
               req_item_id=#{item.reqItemId, jdbcType=BIGINT},
               stock_check_reason=#{item.stockCheckReason, jdbcType=VARCHAR},
               red_item_id=#{item.redItemId, jdbcType=BIGINT},
               del_flag=#{delFlag, jdbcType=INTEGER},
               last_edit_by=#{item.lastEditBy, jdbcType=BIGINT},
               last_edit_name=#{item.lastEditName, jdbcType=VARCHAR},
               last_edit_time=to_date(#{item.lastEditTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               cur_id=#{item.curId, jdbcType=BIGINT},
               account_type=#{item.accountType, jdbcType=BIGINT},
               calc_type=#{item.calcType, jdbcType=BIGINT},
               stock_red_qty=#{item.stockRedQty, jdbcType=INTEGER},
               stock_acc_qty=#{item.stockAccQty, jdbcType=INTEGER},
               stock_budget_qty=#{item.stockBudgetQty, jdbcType=INTEGER},
               stock_cancel_qty=#{item.stockCancelQty, jdbcType=INTEGER},
               stock_back_qty=#{item.stockBackQty, jdbcType=INTEGER},
               acc_item_id=#{item.accItemId, jdbcType=BIGINT},
               budget_item_id=#{item.budgetItemId, jdbcType=BIGINT},
               cancel_item_id=#{item.cancelItemId, jdbcType=BIGINT},
               return_item_id=#{item.returnItemId, jdbcType=BIGINT},
               back_item_id=#{item.backItemId, jdbcType=BIGINT}
         WHERE item_id = #{item.itemId, jdbcType=BIGINT}
    </foreach>
    </update>

</mapper>
