<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!--
手术病人信息视图操作相关SQL Mapper
@author Lanpz
@date 2016-08-02
@source Generated by MySQL2Java
-->

<!-- 此命名空间必须和对应Mapper.java文件的命名空间一致 -->
<mapper namespace="com.aek.persistence.oracle.mapper.OHisInpatientInfoMapper">

    <!-- 手术病人信息视图栏位列表 -->
    <resultMap id="rm" type="com.aek.persistence.oracle.beans.HisInpatientInfo">
        <result property="inpatientNo" jdbcType="VARCHAR" column="inpatient_no" />
        <result property="patientName" jdbcType="VARCHAR" column="patient_name" />
        <result property="bedNo" jdbcType="VARCHAR" column="bed_no" />
        <result property="operationName" jdbcType="VARCHAR" column="operation_name" />
        <result property="operationDate" jdbcType="VARCHAR" column="operation_date" />
        <result property="happenDate" jdbcType="VARCHAR" column="happen_date" />
        <result property="operationDoctorNo" jdbcType="VARCHAR" column="operation_doctor_no" />
        <result property="operationDoctorName" jdbcType="VARCHAR" column="operation_doctor_name" />
        <result property="deptNo" jdbcType="VARCHAR" column="dept_no" />
        <result property="deptName" jdbcType="VARCHAR" column="dept_name" />
        <result property="patientNo" jdbcType="INTEGER" column="patient_no" />
        <result property="outFlag" jdbcType="INTEGER" column="js_no" />
        <result property="newOperationNo" jdbcType="VARCHAR" column="new_operation_no" />
        <result property="newOperationName" jdbcType="VARCHAR" column="new_operation_name" />
        <result property="operationId" jdbcType="INTEGER" column="operation_id" />
        <result property="outDate" jdbcType="VARCHAR" column="out_date" />
        <result property="infantFlag" jdbcType="INTEGER" column="infant_flag" />
        <result property="currentDeptNo" jdbcType="VARCHAR" column="current_dept_no" />
        <result property="currentDeptName" jdbcType="VARCHAR" column="current_dept_name" />
        <result property="operationRoomName" jdbcType="VARCHAR" column="operation_room_name" />
        <result property="operationIndex" jdbcType="VARCHAR" column="operation_index" />
        <result property="patientSex" jdbcType="INTEGER" column="patient_sex" />
        <result property="patientAge" jdbcType="INTEGER" column="patient_age" />
        <result property="operationDiagnose" jdbcType="VARCHAR" column="operation_diagnose" />
        <result property="sickInfectFlag" jdbcType="VARCHAR" column="sick_infect_flag" />
    </resultMap>

    <!-- 获取手术病人信息视图 -->
    <select id="getAll" resultMap="rm" parameterType="map" >
        <![CDATA[
          SELECT * FROM 
          ( SELECT a.*,rownum AS row_count FROM his_inpatient_info a
             WHERE rownum<#{end}
               AND (
                     decode(a.operation_date,null,a.happen_date,a.operation_date) >=sysdate-10
                    )
          )
           WHERE row_count>#{begin}
        ]]>
    </select>

</mapper>
