<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!--
库房正常出库记录。操作相关SQL Mapper
@author Lanpz
@date 2016-12-20
@source Generated by MySQL2Java
-->

<!-- 此命名空间必须和对应Mapper.java文件的命名空间一致 -->
<mapper namespace="com.aek.persistence.oracle.mapper.OSdHplStockOutMapper">

    <!-- 库房正常出库记录。栏位列表 -->
    <resultMap id="rm" type="com.aek.persistence.oracle.beans.SdHplStockOut">
        <result property="formId" jdbcType="BIGINT" column="form_id" />
        <result property="formNo" jdbcType="BIGINT" column="form_no" />
        <result property="outType" jdbcType="INTEGER" column="out_type" />
        <result property="stockFlag" jdbcType="INTEGER" column="stock_flag" />
        <result property="areaId" jdbcType="INTEGER" column="area_id" />
        <result property="sysId" jdbcType="BIGINT" column="sys_id" />
        <result property="periodNo" jdbcType="INTEGER" column="period_no" />
        <result property="whOutId" jdbcType="BIGINT" column="wh_out_id" />
        <result property="whOutName" jdbcType="VARCHAR" column="wh_out_name"/>
        <result property="whId" jdbcType="BIGINT" column="wh_id" />
        <result property="whName" jdbcType="VARCHAR" column="wh_name"/>
        <result property="whSiteId" jdbcType="BIGINT" column="wh_site_id" />
        <result property="whSiteName" jdbcType="VARCHAR" column="wh_site_name"/>
        <result property="deptId" jdbcType="BIGINT" column="dept_id" />
        <result property="deptNo" jdbcType="VARCHAR" column="dept_no"/>
        <result property="deptName" jdbcType="VARCHAR" column="dept_name"/>
        <result property="accountType" jdbcType="BIGINT" column="account_type" />
        <result property="accountTypeStr" jdbcType="VARCHAR" column="account_type_str"/>
        <result property="calcType" jdbcType="BIGINT" column="calc_type" />
        <result property="calcTypeStr" jdbcType="VARCHAR" column="calc_type_str"/>
        <result property="fundsSource" jdbcType="BIGINT" column="funds_source" />
        <result property="fundsSourceStr" jdbcType="VARCHAR" column="funds_source_str"/>
        <result property="requestUser" jdbcType="BIGINT" column="request_user" />
        <result property="originalForm" jdbcType="BIGINT" column="original_form" />
        <result property="receiverType" jdbcType="INTEGER" column="receiver_type" />
        <result property="receiverNote" jdbcType="VARCHAR" column="receiver_note" />
        <result property="receiverName" jdbcType="VARCHAR" column="receiver_name" />
        <result property="receiverAddr" jdbcType="VARCHAR" column="receiver_addr" />
        <result property="receiverPhone" jdbcType="VARCHAR" column="receiver_phone" />
        <result property="formQty" jdbcType="INTEGER" column="form_qty" />
        <result property="formAmount" jdbcType="VARCHAR" column="form_amount" />
        <result property="outAmount" jdbcType="VARCHAR" column="out_amount" />
        <result property="formStatus" jdbcType="INTEGER" column="form_status" />
        <result property="formRemark" jdbcType="VARCHAR" column="form_remark" />
        <result property="printTimes" jdbcType="INTEGER" column="print_times" />
        <result property="redTimes" jdbcType="INTEGER" column="red_times" />
        <result property="redFlag" jdbcType="INTEGER" column="red_flag" />
        <result property="redFormId" jdbcType="BIGINT" column="red_form_id" />
        <result property="stockInFormId" jdbcType="BIGINT" column="stock_in_form_id" />
        <result property="submitBy" jdbcType="BIGINT" column="submit_by" />
        <result property="submitName" jdbcType="VARCHAR" column="submit_name" />
        <result property="submitTime" jdbcType="VARCHAR" column="submit_time_format" />
        <result property="approveBy" jdbcType="BIGINT" column="approve_by" />
        <result property="approveName" jdbcType="VARCHAR" column="approve_name" />
        <result property="approveTime" jdbcType="VARCHAR" column="approve_time_format" />
        <result property="accountBy" jdbcType="BIGINT" column="account_by" />
        <result property="accountName" jdbcType="VARCHAR" column="account_name" />
        <result property="accountTime" jdbcType="VARCHAR" column="account_time_format" />
        <result property="addBy" jdbcType="BIGINT" column="add_by" />
        <result property="addName" jdbcType="VARCHAR" column="add_name" />
        <result property="addTime" jdbcType="VARCHAR" column="add_time_format"/>
        <result property="lastEditBy" jdbcType="BIGINT" column="last_edit_by" />
        <result property="lastEditName" jdbcType="VARCHAR" column="last_edit_name" />
        <result property="lastEditTime" jdbcType="VARCHAR" column="last_edit_time_format" />
        <result property="deptRoomId" jdbcType="BIGINT" column="dept_room_id" />
        <result property="inpatientNo" jdbcType="VARCHAR" column="inpatient_no" />
        <result property="patientName" jdbcType="VARCHAR" column="patient_name" />
        <result property="bedNo" jdbcType="VARCHAR" column="bed_no" />
        <result property="deptRoomName" jdbcType="VARCHAR" column="dept_room_name" />
    </resultMap>

    <!-- 获取库房正常出库记录。 -->
    <select id="getList" resultMap="rm" parameterType="java.util.Map">
        SELECT *
          FROM sd_hpl_stock_out
         WHERE form_id IN
        <foreach collection="list" item="item" separator="," open="(" close=")">
            #{item.formId}
        </foreach>
    </select>
    
    <select id="getCount" resultType="int">
        SELECT count(*) 
          FROM sd_hpl_stock_out
    </select>

    <!-- 添加库房正常出库记录。 -->
    <insert id="insertList" parameterType="java.util.List">
        INSERT INTO sd_hpl_stock_out(form_id,form_no,out_type,stock_flag,area_id,sys_id,period_no,wh_out_id,wh_out_name,wh_id,wh_name,wh_site_id,wh_site_name,dept_id,dept_no,dept_name,account_type,account_type_name,calc_type,calc_type_name,funds_source,funds_source_name,request_user,original_form,receiver_type,receiver_note,receiver_name,receiver_addr,receiver_phone,form_qty,form_amount,out_amount,form_status,form_remark,print_times,red_times,red_flag,red_form_id,stock_in_form_id,submit_by,submit_name,submit_time,approve_by,approve_name,approve_time,account_by,account_name,account_time,add_by,add_name,add_time,del_flag,last_edit_by,last_edit_name,last_edit_time,dept_room_id,inpatient_no,patient_name,bed_no,dept_room_name)
        <foreach collection="list" separator=" union all " item="item">
        SELECT 
               #{item.formId, jdbcType=BIGINT},
               #{item.formNo, jdbcType=BIGINT},
               #{item.outType, jdbcType=INTEGER},
               #{item.stockFlag, jdbcType=INTEGER},
               #{item.areaId, jdbcType=INTEGER},
               #{item.sysId, jdbcType=BIGINT},
               #{item.periodNo, jdbcType=INTEGER},
               #{item.whOutId, jdbcType=BIGINT},
               #{item.whOutName, jdbcType=VARCHAR},
               #{item.whId, jdbcType=BIGINT},
               #{item.whName, jdbcType=VARCHAR},
               #{item.whSiteId, jdbcType=BIGINT},
               #{item.whSiteName, jdbcType=VARCHAR},
               #{item.deptId, jdbcType=BIGINT},
               #{item.deptNo, jdbcType=VARCHAR},
               #{item.deptName, jdbcType=VARCHAR},
               #{item.accountType, jdbcType=BIGINT},
               #{item.accountTypeStr, jdbcType=VARCHAR},
               #{item.calcType, jdbcType=BIGINT},
               #{item.calcTypeStr, jdbcType=VARCHAR},
               #{item.fundsSource, jdbcType=BIGINT},
               #{item.fundsSourceStr, jdbcType=VARCHAR},
               #{item.requestUser, jdbcType=BIGINT},
               #{item.originalForm, jdbcType=BIGINT},
               #{item.receiverType, jdbcType=INTEGER},
               #{item.receiverNote, jdbcType=VARCHAR},
               #{item.receiverName, jdbcType=VARCHAR},
               #{item.receiverAddr, jdbcType=VARCHAR},
               #{item.receiverPhone, jdbcType=VARCHAR},
               #{item.formQty, jdbcType=INTEGER},
               #{item.formAmount, jdbcType=VARCHAR},
               #{item.outAmount, jdbcType=VARCHAR},
               #{item.formStatus, jdbcType=INTEGER},
               #{item.formRemark, jdbcType=VARCHAR},
               #{item.printTimes, jdbcType=INTEGER},
               #{item.redTimes, jdbcType=INTEGER},
               #{item.redFlag, jdbcType=INTEGER},
               #{item.redFormId, jdbcType=BIGINT},
               #{item.stockInFormId, jdbcType=BIGINT},
               #{item.submitBy, jdbcType=BIGINT},
               #{item.submitName, jdbcType=VARCHAR},
               to_date(#{item.submitTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.approveBy, jdbcType=BIGINT},
               #{item.approveName, jdbcType=VARCHAR},
               to_date(#{item.approveTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.accountBy, jdbcType=BIGINT},
               #{item.accountName, jdbcType=VARCHAR},
               to_date(#{item.accountTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.addBy, jdbcType=BIGINT},
               #{item.addName, jdbcType=VARCHAR},
               to_date(#{item.addTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.delFlag, jdbcType=INTEGER},
               #{item.lastEditBy, jdbcType=BIGINT},
               #{item.lastEditName, jdbcType=VARCHAR},
               to_date(#{item.lastEditTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               #{item.deptRoomId, jdbcType=BIGINT},
               #{item.inpatientNo, jdbcType=VARCHAR},
               #{item.patientName, jdbcType=VARCHAR},
               #{item.bedNo, jdbcType=VARCHAR},
               #{item.deptRoomName, jdbcType=VARCHAR}
        FROM dual
        </foreach>
    </insert>

    <!-- 修改库房正常出库记录。 -->
    <update id="updateList" parameterType="java.util.List">
    <foreach collection="list" item="item" separator=";" open="BEGIN " close=";END;">
        UPDATE sd_hpl_stock_out
           SET form_no=#{item.formNo, jdbcType=BIGINT},
               out_type=#{item.outType, jdbcType=INTEGER},
               stock_flag=#{item.stockFlag, jdbcType=INTEGER},
               period_no=#{item.periodNo, jdbcType=INTEGER},
               wh_out_id=#{item.whOutId, jdbcType=BIGINT},
               wh_out_name=#{item.whOutName, jdbcType=VARCHAR},
               wh_id=#{item.whId, jdbcType=BIGINT},
               wh_name=#{item.whName, jdbcType=VARCHAR},
               wh_site_id=#{item.whSiteId, jdbcType=BIGINT},
               wh_site_name=#{item.whSiteName, jdbcType=VARCHAR},
               dept_id=#{item.deptId, jdbcType=BIGINT},
               dept_no=#{item.deptNo, jdbcType=VARCHAR},
               dept_name=#{item.deptName, jdbcType=VARCHAR},
               account_type=#{item.accountType, jdbcType=BIGINT},
               account_type_name=#{item.accountTypeName, jdbcType=VARCHAR},
               calc_type=#{item.calcType, jdbcType=BIGINT},
               calc_type_name=#{item.calcTypeName, jdbcType=VARCHAR},
               funds_source=#{item.fundsSource, jdbcType=BIGINT},
               funds_source_name=#{item.fundsSourceName, jdbcType=VARCHAR},
               request_user=#{item.requestUser, jdbcType=BIGINT},
               original_form=#{item.originalForm, jdbcType=BIGINT},
               receiver_type=#{item.receiverType, jdbcType=INTEGER},
               receiver_note=#{item.receiverNote, jdbcType=VARCHAR},
               receiver_name=#{item.receiverName, jdbcType=VARCHAR},
               receiver_addr=#{item.receiverAddr, jdbcType=VARCHAR},
               receiver_phone=#{item.receiverPhone, jdbcType=VARCHAR},
               form_qty=#{item.formQty, jdbcType=INTEGER},
               form_amount=#{item.formAmount, jdbcType=DOUBLE},
               out_amount=#{item.outAmount, jdbcType=DOUBLE},
               form_status=#{item.formStatus, jdbcType=INTEGER},
               form_remark=#{item.formRemark, jdbcType=VARCHAR},
               print_times=#{item.printTimes, jdbcType=INTEGER},
               red_times=#{item.redTimes, jdbcType=INTEGER},
               red_flag=#{item.redFlag, jdbcType=INTEGER},
               red_form_id=#{item.redFormId, jdbcType=INTEGER},
               stock_in_form_id=#{item.stockInFormId, jdbcType=INTEGER},
               submit_by=#{item.submitBy, jdbcType=BIGINT},
               submit_name=#{item.submitName, jdbcType=VARCHAR},
               submit_time=to_date(#{item.submitTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               approve_by=#{item.approveBy, jdbcType=BIGINT},
               approve_name=#{item.approveName, jdbcType=VARCHAR},
               approve_time=to_date(#{item.approveTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               account_by=#{item.accountBy, jdbcType=BIGINT},
               account_name=#{item.accountName, jdbcType=VARCHAR},
               account_time=to_date({item.accountTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               last_edit_by=#{item.lastEditBy, jdbcType=BIGINT},
               last_edit_name=#{item.lastEditName, jdbcType=VARCHAR},
               last_edit_time=to_date(#{item.lastEditTime, jdbcType=VARCHAR}, 'yyyy-MM-dd HH24:MI:SS'),
               dept_room_id=#{item.deptRoomId, jdbcType=BIGINT},
               inpatient_no=#{item.inpatientNo, jdbcType=VARCHAR},
               patient_name=#{item.patientName, jdbcType=VARCHAR},
               bed_no=#{item.bedNo, jdbcType=VARCHAR},
               dept_room_name=#{item.deptRoomName, jdbcType=VARCHAR}
         WHERE form_id = #{item.formId, jdbcType=BIGINT}
           AND area_id = #{item.areaId, jdbcType=INTEGER}
           AND sys_id = #{item.sysId, jdbcType=BIGINT}
    </foreach>
    </update>

</mapper>
