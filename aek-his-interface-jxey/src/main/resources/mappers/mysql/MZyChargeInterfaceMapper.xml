<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!--
病人收费信息操作相关SQL Mapper
@author Lanpz
@date 2016-08-04
@source Generated by MySQL2Java
-->

<!-- 此命名空间必须和对应Mapper.java文件的命名空间一致 -->
<mapper namespace="com.aek.persistence.mysql.mapper.MZyChargeInterfaceMapper">

    <!-- 病人收费信息栏位列表 -->
    <resultMap id="rm" type="com.aek.persistence.oracle.beans.ZyChargeInterface">
        <result property="id" jdbcType="INTEGER" column="id" />
        <result property="oldid" jdbcType="INTEGER" column="oldid" />
        <result property="medicardno" jdbcType="VARCHAR" column="medicardno" />
        <result property="patientno" jdbcType="INTEGER" column="patientno" />
        <result property="infantflag" jdbcType="INTEGER" column="infantflag" />
        <result property="chargecode" jdbcType="INTEGER" column="chargecode" />
        <result property="chargename" jdbcType="VARCHAR" column="chargename" />
        <result property="systemtype" jdbcType="VARCHAR" column="systemtype" />
        <result property="systemid" jdbcType="VARCHAR" column="systemid" />
        <result property="chargedate" jdbcType="VARCHAR" column="chargedate" />
        <result property="amount" jdbcType="DOUBLE" column="amount" />
        <result property="price" jdbcType="DOUBLE" column="price" />
        <result property="fee" jdbcType="DOUBLE" column="fee" />
        <result property="doctorid" jdbcType="VARCHAR" column="doctorid" />
        <result property="executdept" jdbcType="VARCHAR" column="executdept" />
        <result property="admisssickroom" jdbcType="VARCHAR" column="admisssickroom" />
        <result property="admisssickdept" jdbcType="VARCHAR" column="admisssickdept" />
        <result property="operatid" jdbcType="VARCHAR" column="operatid" />
        <result property="auditid" jdbcType="VARCHAR" column="auditid" />
        <result property="sendflag" jdbcType="INTEGER" column="sendflag" />
        <result property="beinhosflag" jdbcType="INTEGER" column="beinhosflag" />
        <result property="operatedate" jdbcType="VARCHAR" column="operatedate" />
        <result property="concurflag" jdbcType="VARCHAR" column="concurflag" />
        <result property="invoiceNo" jdbcType="VARCHAR" column="invoice_no" />
        <result property="invoiceDoctorcode" jdbcType="VARCHAR" column="invoice_doctorcode" />
        <result property="invoiceChargedate" jdbcType="VARCHAR" column="invoice_chargedate" />
        <result property="bxDate" jdbcType="VARCHAR" column="bx_date" />
        <result property="ypcddm" jdbcType="INTEGER" column="ypcddm" />
        <result property="ypxh" jdbcType="INTEGER" column="ypxh" />
        <result property="tcdm" jdbcType="VARCHAR" column="tcdm" />
        <result property="zlybdm" jdbcType="VARCHAR" column="zlybdm" />
        <result property="fybh" jdbcType="INTEGER" column="fybh" />
        <result property="excuteFlag" jdbcType="INTEGER" column="excute_flag"/>
    </resultMap>

    <!-- 获取病人收费信息(排除错误记录信息) -->
    <select id="getList" resultMap="rm" parameterType="java.util.Map">
        SELECT *
          FROM bd_hpl_his_charge_interface 
         WHERE id NOT IN
          (
          SELECT primary_key FROM data_error_info 
           WHERE primary_key is not null
          )
          LIMIT #{begin}, #{end}
    </select>
    
    <!-- 获取接口总和信息 -->
    <select id="getCount" resultType="int">
        SELECT count(*)
          FROM bd_hpl_his_charge_interface
         WHERE id NOT IN
          (
          SELECT primary_key FROM data_error_info 
           WHERE primary_key is not null
             AND is_solved = 0
          ) 
    </select>
    
    <!-- 根据错误记录的id查找到接口信息 -->
    <select id="getListByIds" parameterType="java.util.List" resultMap="rm">
        SELECT *
          FROM bd_hpl_his_charge_interface
        WHERE id IN
        <foreach collection="list" item="item" separator="," open="(" close=")">
            #{item.primaryKey}
        </foreach>
    </select>

</mapper>
