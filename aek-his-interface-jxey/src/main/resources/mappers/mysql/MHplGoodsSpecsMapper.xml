<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!--
物资规格。操作相关SQL Mapper
@author Lanpz
@date 2016-12-15
@source Generated by MySQL2Java
-->

<!-- 此命名空间必须和对应Mapper.java文件的命名空间一致 -->
<mapper namespace="com.aek.persistence.mysql.mapper.MHplGoodsSpecsMapper">

    <!-- 物资规格。栏位列表 -->
    <resultMap id="rm" type="com.aek.persistence.oracle.beans.BdHplGoodsSpecs">
        <result property="specId" jdbcType="BIGINT" column="spec_id" />
        <result property="sysId" jdbcType="BIGINT" column="sys_id" />
        <result property="areaId" jdbcType="INTEGER" column="area_id" />
        <result property="classId" jdbcType="BIGINT" column="class_id" />
        <result property="className" jdbcType="VARCHAR" column="class_name"/> 
        <result property="goodsId" jdbcType="BIGINT" column="goods_id" />
        <result property="goodsName" jdbcType="VARCHAR" column="goods_name"/>
        <result property="goodsType" jdbcType="INTEGER" column="goods_type" />
        <result property="specGuid" jdbcType="VARCHAR" column="spec_guid" />
        <result property="specNo" jdbcType="VARCHAR" column="spec_no" />
        <result property="specBarcode" jdbcType="VARCHAR" column="spec_barcode" />
        <result property="specBarcodeType" jdbcType="INTEGER" column="spec_barcode_type" />
        <result property="specModel" jdbcType="VARCHAR" column="spec_model" />
        <result property="specCommonName" jdbcType="VARCHAR" column="spec_common_name" />
        <result property="specNameEn" jdbcType="VARCHAR" column="spec_name_en" />
        <result property="specNameCn" jdbcType="VARCHAR" column="spec_name_cn" />
        <result property="specPackage" jdbcType="VARCHAR" column="spec_package" />
        <result property="specBigpackstr" jdbcType="VARCHAR" column="spec_bigpackstr" />
        <result property="specBasepackstr" jdbcType="VARCHAR" column="spec_basepackstr" />
        <result property="specBasepackNo" jdbcType="INTEGER" column="spec_basepack_no" />
        <result property="specBasepackNote" jdbcType="VARCHAR" column="spec_basepack_note" />
        <result property="specMinipackstr" jdbcType="VARCHAR" column="spec_minipackstr" />
        <result property="specMiniunit" jdbcType="DOUBLE" column="spec_miniunit" />
        <result property="specDosetype" jdbcType="INTEGER" column="spec_dosetype" />
        <result property="specDose" jdbcType="INTEGER" column="spec_dose" />
        <result property="specDoseuintstr" jdbcType="VARCHAR" column="spec_doseuintstr" />
        <result property="specUsagefunc" jdbcType="INTEGER" column="spec_usagefunc" />
        <result property="specUsages" jdbcType="VARCHAR" column="spec_usages" />
        <result property="instructions" jdbcType="VARCHAR" column="instructions" />
        <result property="chargeFlag" jdbcType="INTEGER" column="charge_flag" />
        <result property="managementFlag" jdbcType="INTEGER" column="management_flag" />
        <result property="medicareFlag" jdbcType="INTEGER" column="medicare_flag" />
        <result property="bidType" jdbcType="INTEGER" column="bid_type" />
        <result property="bidDate" jdbcType="VARCHAR" column="bid_date_format" />
        <result property="bidExpiredDate" jdbcType="VARCHAR" column="bid_expired_date_format" />
        <result property="bidFlag" jdbcType="INTEGER" column="bid_flag" />
        <result property="salePrice" jdbcType="DOUBLE" column="sale_price" />
        <result property="salePriceCurrencyId" jdbcType="BIGINT" column="sale_price_currency_id" />
        <result property="salePriceCurrencyName" jdbcType="VARCHAR" column="sale_price_currency_name" />
        <result property="regId" jdbcType="BIGINT" column="reg_id" />
        <result property="regNo" jdbcType="VARCHAR" column="reg_no"/>
        <result property="goodsUnitId" jdbcType="BIGINT" column="goods_unit_id" />
        <result property="goodsUnitName" jdbcType="VARCHAR" column="goods_unit_name" />
        <result property="bidPrice" jdbcType="DOUBLE" column="bid_price" />
        <result property="bidPriceCurrencyId" jdbcType="BIGINT" column="bid_price_currency_id" />
        <result property="bidPriceCurrencyName" jdbcType="VARCHAR" column="bid_price_currency_name" />
        <result property="unitPrice" jdbcType="DOUBLE" column="unit_price" />
        <result property="unitPriceCurrencyId" jdbcType="BIGINT" column="unit_price_currency_id" />
        <result property="unitPriceCurrencyName" jdbcType="VARCHAR" column="unit_price_currency_name"/>
        <result property="inviteNo" jdbcType="VARCHAR" column="invite_no" />
        <result property="inviteFileno" jdbcType="VARCHAR" column="invite_fileno" />
        <result property="repeatNo" jdbcType="INTEGER" column="repeat_no" />
        <result property="repeatPrice" jdbcType="DOUBLE" column="repeat_price" />
        <result property="repeatPay" jdbcType="DOUBLE" column="repeat_pay" />
        <result property="addBy" jdbcType="BIGINT" column="add_by" />
        <result property="addName" jdbcType="VARCHAR" column="add_name" />
        <result property="addTime" jdbcType="VARCHAR" column="add_time_format" />
        <result property="lastEditBy" jdbcType="BIGINT" column="last_edit_by" />
        <result property="lastEditName" jdbcType="VARCHAR" column="last_edit_name" />
        <result property="lastEditTime" jdbcType="VARCHAR" column="last_time_format" />
        <result property="sourceFlag" jdbcType="INTEGER" column="source_flag" />
        <result property="delFlag" jdbcType="INTEGER" column="del_flag" />
    </resultMap>

    <!-- 获取物资规格。 -->
    <select id="getSpecList" resultMap="rm" parameterType="java.util.Map">
        SELECT spec.*, reg.reg_no, goods.goods_name,
               price.code_text AS sale_price_currency_name,
               unit.code_text AS goods_unit_name,
               bid_price.code_text AS bid_price_currency_name,
               unit_price.code_text AS unit_price_currency_name,
               date_format(spec.add_time,'%Y-%m-%d %T') AS add_time_format,
               date_format(spec.last_edit_time,'%Y-%m-%d %T') AS last_time_format,
               date_format(spec.bid_expired_date,'%Y-%m-%d %T') AS bid_expired_date_format,
               date_format(spec.bid_date,'%Y-%m-%d %T') AS bid_date_format
          FROM herp.bd_hpl_goods_specs spec
          LEFT JOIN herp.base_goods_reg reg ON spec.reg_id = reg.reg_id
          LEFT JOIN herp.bd_hpl_goodses goods ON spec.goods_id = goods.goods_id
          LEFT JOIN herp.bd_hpl_code_info price ON spec.sale_price_currency_id=price.code_id
          LEFT JOIN herp.bd_hpl_code_info unit ON spec.goods_unit_id=unit.code_id
          LEFT JOIN herp.bd_hpl_code_info unit_price ON unit_price.code_id=spec.unit_price_currency_id
          LEFT JOIN herp.bd_hpl_code_info bid_price ON bid_price.code_id=spec.bid_price_currency_id
        <if test="null != dateFlag and 1 == dateFlag">
         WHERE IFNULL(DATE_FORMAT(spec.last_edit_time,'%Y-%m-%d'),DATE_FORMAT(spec.add_time,'%Y-%m-%d')) = DATE_FORMAT(SYSDATE(),'%Y-%m-%d')
        </if>
         LIMIT #{begin}, #{end}
    </select>


</mapper>
